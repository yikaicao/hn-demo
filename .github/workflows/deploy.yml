name: ansible-eb-deployment

on:
  workflow_call:
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          repository: yikaicao/yikai-spring-demos
          token: ${{secrets.gh_actions}}
          persist-credentials: false
          path: ./001-spring-framework-demo-xml
      - name: where am I?
        run: |
          pwd
          ls
      - name: install ansible
        run: |
          sudo apt-add-repository ppa:ansible/ansible
          sudo apt update
          sudo apt-get install -y ansible
          ansible-playbook --version
      - name: install eb-cli
        run: |
          curl -O https://bootstrap.pypa.io/get-pip.py
          python3 get-pip.py --user
          pip install awsebcli --upgrade --user
          eb --version
